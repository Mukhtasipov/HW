# Домашнее задание к занятию "`Резервное копирование баз данных`" - `Мухтасипов Александр`


Задание 1. Резервное копирование
Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.

Необходимо описать, какие варианты резервного копирования подходят в случаях:

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

Подходит полное резервное копирование (Full Backup), выполняемое ежедневно. Такой бэкап содержит все данные на момент создания и позволяет восстановить систему до состояния на конец предыдущего дня.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

Используется комбинация:

Полный бэкап (например, раз в сутки).

Транзакционные логи (WAL, бинарные логи) с частым сохранением (например, каждые 15 минут).

Восстановление происходит в два этапа:

Восстановление из последнего полного бэкапа.

Применение транзакционных логов до нужного момента времени (за час до поломки).

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

Да, это возможно при использовании репликации и отказоустойчивых кластеров. Примеры:

PostgreSQL: Синхронная потоковая репликация + инструменты вроде Patroni.

MySQL: Репликация Master-Slave или кластерные решения (InnoDB Cluster, Galera).

Автоматическое переключение (failover) через HA-решения (Pacemaker, Keepalived) или облачные managed-сервисы.



Задание 2. PostgreSQL
2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

Создание резервной копии  pg_dump -Fc -U postgres mydb > mydb_backup.dump

Восстановление из резервной копии: pg_restore -U postgres -d mydb mydb_backup.dump

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

Скрипты + cron: 0 2 * * * pg_dump -Fc -U postgres mydb > /backups/mydb_$(date +\%F).dump  Пример cron-задачи для ежедневного бэкапа


Задание 3. MySQL
3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.

Копирование бинарных логов, созданных после последнего полного бэкапа:

mysqlbinlog --start-position=<POSITION> /var/lib/mysql/binlog.00000X > incremental_backup.sql

<POSITION> берется из полного бэкапа или последнего инкрементного.

---